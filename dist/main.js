(()=>{"use strict";const e="https://bytegrad.com/course-assets/js/2/api",t={searchJobItems:[],bookmarkJobitems:[],activeJobItem:{},currentPage:1},o=document.querySelector(".bookmarks-btn"),s=document.querySelector(".error"),i=document.querySelector(".error__text"),a=document.querySelector(".job-details"),n=document.querySelector(".job-details__content"),c=document.querySelector(".job-list--bookmarks"),r=document.querySelector(".job-list--search"),l=document.querySelector(".count__number"),b=document.querySelector(".pagination"),d=document.querySelector(".pagination__button--next"),m=document.querySelector(".pagination__button--back"),_=(document.querySelector(".pagination__number--next"),document.querySelector(".pagination__number--back"),document.querySelector(".search")),u=document.querySelector(".search__input"),v=document.querySelector(".sorting"),k=document.querySelector(".sorting__button--relevant"),g=document.querySelector(".sorting__button--recent"),f=document.querySelector(".spinner--search"),p=document.querySelector(".spinner--job-details"),j=async e=>{const t=await fetch(e),o=await t.json();if(!t.ok)throw new Error(o.description);return o},h=e=>{("search"===e?f:p).classList.toggle("spinner--visible")},y=e=>{const o=`\n         <img src="${e.coverImgURL}" alt="#" class="job-details__cover-img">\n\n         <a class="apply-btn" href="${e.companyURL}" target="_blank">Apply <i class="fa-solid fa-square-arrow-up-right apply-btn__icon"></i></a>\n\n         <section class="job-info">\n         <div class="job-info__left">\n            <div class="job-info__badge">${e.badgeLetters}</div>\n            <div class="job-info__below-badge">\n                <time class="job-info__time">${e.daysAgo}d</time>\n                <button class="job-info__bookmark-btn">\n                    <i class="fa-solid fa-bookmark job-info__bookmark-icon ${t.bookmarkJobitems.some((t=>t.id===e.id))&&"job-info__bookmark-icon--bookmarked"}"></i>\n                </button>\n            </div>\n         </div>\n         <div class="job-info__right">\n            <h2 class="second-heading">${e.title}</h2>\n            <p class="job-info__company">${e.company}</p>\n            <p class="job-info__description">${e.description}</p>\n            <div class="job-info__extras">\n                <p class="job-info__extra"><i class="fa-solid fa-clock job-info__extra-icon"></i> ${e.duration}</p>\n                <p class="job-info__extra"><i class="fa-solid fa-money-bill job-info__extra-icon"></i> ${e.salary}</p>\n                <p class="job-info__extra"><i class="fa-solid fa-location-dot job-info__extra-icon"></i> ${e.location}</p>\n            </div>\n         </div>\n    </section>\n\n    <div class="job-details__other">\n        <section class="qualifications">\n            <div class="qualifications__left">\n                <h4 class="fourth-heading">Qualifications</h4>\n                <p class="qualifications__sub-text">Other qualifications may apply</p>\n            </div>\n            <ul class="qualifications__list">\n                ${e.qualifications.map((e=>`<li class="qualifications__item">${e}</li>`)).join("")}\n            </ul>\n        </section>\n        \n        <section class="reviews">\n            <div class="reviews__left">\n                <h4 class="fourth-heading">Company reviews</h4>\n                <p class="reviews__sub-text">Recent things people are saying</p>\n            </div>\n            <ul class="reviews__list">\n                ${e.reviews.map((e=>`<li class="reviews__item">${e}</li>`)).join("")}\n            </ul>\n        </section>\n    </div>\n\n    <footer class="job-details__footer">\n        <p class="job-details__footer-text">If possible, please reference that you found the job on <span class="u-bold">rmtDev</span>, we would really appreciate it!</p>\n    </footer>\n`;n.innerHTML=o},L=(e="Something went wrong!")=>{i.textContent=e,s.classList.add("error--visible"),setTimeout((()=>{s.classList.remove("error--visible")}),3500)},$=(e="search")=>{let o;r.innerHTML="","search"===e?o=t.searchJobItems.slice(7*t.currentPage-7,7*t.currentPage):"bookmarks"===e&&(o=t.bookmarkJobitems),o.forEach((e=>{const o=` \n        <li class="job-item ${t.activeJobItem.id===e.id?"job-item--active":""}">\n        <a class="job-item__link" href="${e.id}">\n            <div class="job-item__badge">${e.badgeLetters}</div>\n            <div class="job-item__middle">\n                <h3 class="third-heading">${e.title}</h3>\n                <p class="job-item__company">${e.company}</p>\n                <div class="job-item__extras">\n                    <p class="job-item__extra"><i class="fa-solid fa-clock job-item__extra-icon"></i> ${e.duration}</p>\n                    <p class="job-item__extra"><i class="fa-solid fa-money-bill job-item__extra-icon"></i>${e.salary}</p>\n                    <p class="job-item__extra"><i class="fa-solid fa-location-dot job-item__extra-icon"></i>${e.location}</p>\n                </div>\n            </div>\n            <div class="job-item__right">\n                <i class="fa-solid fa-bookmark job-item__bookmark-icon jobItem__bookmark-icon--bookmarked ${t.bookmarkJobitems.some((t=>t.id===e.id))&&"job-item__bookmark-icon--bookmarked"}"></i>\n                <time class="job-item__time">${e.daysAgo}d</time>\n            </div>\n        </a>\n    </li>\n    `;r.insertAdjacentHTML("beforeend",o)}))},q=async o=>{o.preventDefault();const s=o.target.closest(".job-item");document.querySelectorAll(".job-item--active").forEach((e=>e.classList.remove("job-item--active"))),n.innerHTML="",h("job-details");const i=s.children[0].getAttribute("href"),a=[...t.activeJobItem,...t.bookmarkJobitems];t.activeJobItem=a.find((e=>e.id===+i)),$(),history.pushState(null,"",`/#${i}`);try{const t=await j(`${e}/jobs/${i}`),{jobItem:o}=t;h("job-details"),y(o)}catch(e){h("job-details"),L(e.message)}};r.addEventListener("submit",q),c.addEventListener("submit",q);const S=$;a.addEventListener("click",(()=>{event.target.claasName.includes("bookmark")||(t.bookmarkJobitems.some((e=>e.id===t.activeJobItem.id))?t.bookmarkJobitems=t.bookmarkJobitems.filter((e=>e.id!==t.activeJobItem.id)):t.bookmarkJobitems.push(t.activeJobItem),localStorage.setItem("bookmarkJobItems",JSON.stringify(t.bookmarkJobitems)),document.querySelector(".job-info__bookamrk-icon").classList.toggle("job-info__bookmark-icon--bookmarked"),S())})),o.addEventListener("mouseenter",(()=>{o.classList.add("bookmarks-btn--active"),c.classList.add("job-list--visible"),S("bookmarks")})),c.addEventListener("mouseleave",(()=>{o.classList.add("bookmarks-btn--active"),c.classList.add("job-list--visible")}));const J=()=>{t.currentPage>=2?m.classList.remove("pagination__button--hidden"):m.classList.add("pagination__button--hidden"),(t.searchJobItems.length=7*t.currentPage)<=0?d.classList.add("pagination__button--hidden"):d.classList.remove("pagination__button--hidden"),d.textContent=t.currentPage+1,m.textContent=t.currentPage-1,d.blur(),m.blur()};b.addEventListener("click",(e=>{const o=e.target.closest(".pagination__button");o&&(o.className.includes("--next")?t.currentPage++:t.currentPage--,J(),S())}));const w=J,x=async()=>{const o=window.location.hash.substring(1);if(o){document.querySelectorAll(".job-item--active").forEach((e=>e.classList.remove("job-item--active"))),n.innerHTML="",h("job-details");try{const s=await j(`${e}/jobs/${o}`),{jobItem:i}=s;t.activeJobItem=i,S(),h("job-details"),y(i)}catch(e){h("job-details"),L(e.message)}}};window.addEventListener("DOMContentLoaded",x),window.addEventListener("hashchange",x),_.addEventListener("submit",(async o=>{o.preventDefault();const s=u.value;if(/[0-9]/.test(s))L("Your search may not contain numbers");else{u.blur(),r.innerHTML="",g.classList.remove("sorting__button--active"),k.classList.add("sorting__button--active"),h("search");try{const o=await j(`${e}/jobs?search=${s}`),{jobItems:i}=o;t.searchJobItems=i,t.currentPage=1,h("search"),l.textContent=i.length,w(),S()}catch(e){h("search"),L(e.message)}}})),v.addEventListener("click",(e=>{const o=e.target.closest(".sorting__button");if(!o)return;t.currentPage=1;const s=!!o.className.includes("--recent");s?(g.classList.add("sorting__button--active"),k.classList.remove("sorting__button--active")):(g.classList.remove("sorting__button--active"),k.classList.add("sorting__button--active")),s?t.searchJobItems.sort(((e,t)=>e.daysAgo-t.daysAgo)):t.searchJobItems.sort(((e,t)=>t.relevantScore-e.relevantScore)),w(),S()}));const I=localStorage.getItem("bookmarkJobItems");I&&(t.bookmarkJobitems=JSON.parse(I))})();